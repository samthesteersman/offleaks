---
title: "Little analysis"
output: html_document
---

This project for Social and Economic Networks course uses Offshore Leaks Database found here <https://offshoreleaks.icij.org/>.

```{r, echo = FALSE}
# loading files
addresses <- read.csv(file = 'offshore_leaks_csvs-20160513/Addresses.csv')
edges <- read.csv(file = 'offshore_leaks_csvs-20160513/all_edges.csv')
entities <- read.csv(file = 'offshore_leaks_csvs-20160513/Entities.csv')
inters <- read.csv(file = 'offshore_leaks_csvs-20160513/Intermediaries.csv')
officers <- read.csv(file = 'offshore_leaks_csvs-20160513/Officers.csv')
```

```{r, include = FALSE}
# loading libraries
library(dplyr)
library(ggplot2)
```

## Year development

One would like to know how many accounts have been opened throughout years.

```{r, echo = FALSE}
# looking at available dates of the accounts creation
ent <- entities
ent$incorporation_date <- as.Date(x = as.character(ent$incorporation_date), format = "%d-%b-%Y")
ent <- ent[!is.na(ent$incorporation_date),]
ent$incorporation_year <- as.numeric(format(ent$incorporation_date, "%Y"))
```

The sample size for answering this question is `r nrow(ent)`.

The earliest opened account belongs to `r min(ent$incorporation_year)` and the latest comes from the future `r max(ent$incorporation_year)`.

The most fruitful years for the offshore accounts are the following:

```{r, echo = FALSE}
head(arrange(count(ent, incorporation_year), desc(n)))
```

Overall, that is how the process looks like:

```{r, echo = FALSE}
ggplot(data = ent) + geom_bar(aes(x = incorporation_year)) + theme_bw()
```